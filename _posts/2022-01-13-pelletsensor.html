---
layout: post
title: Pelletsensor - Füllstandsanzeige mit ESP8266 & Ultraschallsensor
date: 2022-01-13 12:41:14.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Blog
- HomeAssistant
tags:
- 3D Drucker
- ESP8266
- Füllstandsanzeige
- Hassio
- Home Assistant
- Home Automation
- Pelletsensor
- Pelletstank
- Tinkercad
- Ultraschallsensor
- Wandgehäuse
- WeMosD1
meta:
  rank_math_seo_score: '82'
  rank_math_focus_keyword: Pelletsensor
  _edit_last: '1'
  _ez-toc-disabled: ''
  _ez-toc-insert: ''
  _ez-toc-heading-levels: a:0:{}
  _ez-toc-alttext: ''
  _ez-toc-exclude: ''
  rank_math_internal_links_processed: '1'
  _wp_old_slug: pelletsensor-fullstandsanzeige-mit-wemos-d1-ultraschallsensor
  rank_math_primary_category: '13'
  rank_math_og_content_image: a:2:{s:5:"check";s:32:"0b2562f3b028456332b03c05b7b0ebe3";s:6:"images";a:1:{i:0;i:805;}}
author:
  login: smon
  email: simon_eisele@web.de
  display_name: Simon Eisele
  first_name: Simon
  last_name: Eisele
permalink: "/2022/01/13/pelletsensor/"
---
<p><!-- wp:paragraph --></p>
<p>Mit der Hilfe eines WEMOS D1 und eines einfachen Radar Sensors kann im Pellet Tank der aktuelle Füllstand gemessen und grafisch dargestellt werden. In meinem Fall verarbeite ich die Werte mittels HomeAssistant (hassio). Im Falle von einer geringen Füllstandsmenge kann als Beispiel eine Benachrichtigung per Telegram eingerichtet werden.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2><strong>Benötigte Hardware</strong></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:columns {"align":"wide"} --></p>
<div class="wp-block-columns alignwide"><!-- wp:column {"width":"50%"} --></p>
<div class="wp-block-column" style="flex-basis:50%"><!-- wp:list --></p>
<ul id="block-b4e69051-d74a-4984-84e1-d9ece7b8a5d7">
<li><a href="https://www.amazon.de/AZDelivery-ESP8266-ESP-8266EX-Entwicklung-inklusive/dp/B08BTXCZC1/ref=sr_1_2_sspa?__mk_de_DE=ÅMÅŽÕÑ&amp;crid=U8KOMRZ4GI5M&amp;keywords=wemos%2Bd1&amp;qid=1642017050&amp;sprefix=wemos%2Bd1%2Caps%2C62&amp;sr=8-2-spons&amp;smid=A1X7QLRQH87QA3&amp;spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUEzVlVIOFVOVk43M1lRJmVuY3J5cHRlZElkPUEwMDIxNjgwMVg0SVZUNzc2MVNYNiZlbmNyeXB0ZWRBZElkPUEwNzAwMTYyVlRVQ0xJMEdPQk1CJndpZGdldE5hbWU9c3BfYXRmJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ&amp;th=1" target="_blank" rel="noreferrer noopener">WeMos D1</a></li>
<li><a href="https://www.amazon.de/Ultraschallwellen-Entfernungs-Messbrett-Ranging-Wasserdichtem/dp/B076SWF5FV/ref=asc_df_B076SWF5FV/?tag=googshopde-21&amp;linkCode=df0&amp;hvadid=207958123109&amp;hvpos=&amp;hvnetw=g&amp;hvrand=2429683880360571440&amp;hvpone=&amp;hvptwo=&amp;hvqmt=&amp;hvdev=c&amp;hvdvcmdl=&amp;hvlocint=&amp;hvlocphy=9041871&amp;hvtargid=pla-466570717578&amp;psc=1&amp;th=1&amp;psc=1" target="_blank" rel="noreferrer noopener">Ultraschallsensor Wasserdicht</a></li>
<li><a href="https://affengriff.net/category/3d-prints/" target="_blank" rel="noreferrer noopener">3D Drucker</a></li>
<li><a href="https://www.bauhaus.info/schalterdosen-deckel/abzweigdose/p/12165125?ef_id=Cj0KCQiAuP-OBhDqARIsAD4XHpel7Nj7fkhUPnZj6r4L9gY6V7y49IDJaOieZ2ryWZfE8c3YVOD92CkaArGrEALw_wcB:G:s&amp;s_kwcid=AL!5677!3!427263744379!!!g!445337366317!&amp;cid=PSEGoo9709541002_99153654693&amp;pla_campid=9709541002&amp;pla_adgrid=99153654693&amp;pla_prpaid=445337366317&amp;pla_prid=12165125&amp;pla_adt=pla&amp;pla_prch=online&amp;pla_stco=&amp;gclid=Cj0KCQiAuP-OBhDqARIsAD4XHpel7Nj7fkhUPnZj6r4L9gY6V7y49IDJaOieZ2ryWZfE8c3YVOD92CkaArGrEALw_wcB" target="_blank" rel="noreferrer noopener">Abzweigdose für WeMos &amp; Sensorplatine</a></li>
<li><a href="https://www.amazon.de/dp/B01EV70C78/ref=redir_mobile_desktop?_encoding=UTF8&amp;aaxitk=462d7dfcfffc725cf01b45f7665d90a4&amp;hsa_cr_id=4181511570302&amp;pd_rd_plhdr=t&amp;pd_rd_r=ff46d288-430f-4a4c-8a4e-fef582ba1cb3&amp;pd_rd_w=bNbO0&amp;pd_rd_wg=zVtOt&amp;ref_=sbx_be_s_sparkle_mcd_asin_0_img" target="_blank" rel="noreferrer noopener">Einzeladern</a> </li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></div>
<p><!-- /wp:column --></p>
<p><!-- wp:column {"width":""} --></p>
<div class="wp-block-column"><!-- wp:image {"id":805,"width":224,"height":190} --></p>
<figure class="wp-block-image is-resized"><img src="{{ site.baseurl }}/assets/2022/01/IMG_9295.jpg" alt="" class="wp-image-805" width="224" height="190" /></figure>
<p><!-- /wp:image --></div>
<p><!-- /wp:column --></div>
<p><!-- /wp:columns --></p>
<p><!-- wp:heading --></p>
<h2><strong>Benötigte Software</strong></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:list --></p>
<ul>
<li><a href="https://www.tinkercad.com" target="_blank" rel="noreferrer noopener">TinkerCad</a></li>
<li><a href="https://www.prusa3d.de" target="_blank" rel="noreferrer noopener">PrusaSlicer</a></li>
<li><a href="https://www.home-assistant.io/getting-started/" target="_blank" rel="noreferrer noopener">Home Assistant</a></li>
<li><a href="https://esphome.io" target="_blank" rel="noreferrer noopener">ESP Home</a></li>
<li><a href="https://esphome.io/components/sensor/ultrasonic.html" target="_blank" rel="noreferrer noopener">Ultraschallsensor ESPHome</a></li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2><strong>3D Gehäuse Tinkercad</strong></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:list --></p>
<ul>
<li><a href="https://www.tinkercad.com/things/hMeTBKCHtJG" target="_blank" rel="noreferrer noopener">Wandgehäuse 35 grad</a></li>
<li><a href="https://www.tinkercad.com/things/kUD2l47NRp0" target="_blank" rel="noreferrer noopener">Wandgehäuse 30 grad</a></li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2><strong>Aufbau</strong> <strong>Pelletsensor</strong></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:gallery {"linkTo":"none"} --></p>
<figure class="wp-block-gallery has-nested-images columns-default is-cropped"><!-- wp:image {"id":789,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{ site.baseurl }}/assets/2022/01/IMG_9293.jpg" alt="" class="wp-image-789" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:image {"id":800,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{ site.baseurl }}/assets/2022/01/Bildschirmfoto-2022-01-13-um-12.45.56-851x1024.png" alt="" class="wp-image-800" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:image {"id":804,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{ site.baseurl }}/assets/2022/01/IMG_9294-768x1024.jpg" alt="" class="wp-image-804" /></figure>
<p><!-- /wp:image --></figure>
<p><!-- /wp:gallery --></p>
<p><!-- wp:heading --></p>
<h2><strong>ESP Home config.yaml</strong></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Update Intervall ist hier in der yaml auf 1h eingestellt. Somit wird jede Stunde der Füllstand abgefragt.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code lang="yaml" class="language-yaml">esphome:
  name: ultraschall
  platform: ESP8266
  board: d1_mini

# Enable logging
logger:

# Enable Home Assistant API
api:

ota:
  password: „XXX“

wifi:
  networks:
  - ssid: XXX
    password: XXX
  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: Ultraschall
    password: XXX

captive_portal:

sensor:
  - platform: ultrasonic
    trigger_pin: D1
    echo_pin: D2
    name: "Pelletsfüllstand"
    update_interval: 1h</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading --></p>
<h2><strong>Home Assistant grafische Darstellung</strong></h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:media-text {"mediaId":790,"mediaType":"image","mediaWidth":40} --></p>
<div class="wp-block-media-text alignwide is-stacked-on-mobile" style="grid-template-columns:40% auto">
<figure class="wp-block-media-text__media"><img src="{{ site.baseurl }}/assets/2022/01/IMG_9255.jpg" alt="" class="wp-image-790 size-full" /></figure>
<div class="wp-block-media-text__content"><!-- wp:paragraph {"placeholder":"Content…","fontSize":"large"} --></p>
<p class="has-large-font-size">
<p><!-- /wp:paragraph --></div>
</div>
<p><!-- /wp:media-text --></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>
